{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#toynlp","title":"ToyNLP","text":"<p>Implementing classic NLP models from scratch with clean code and easy-to-understand architecture.</p> <p>This library is for educational purposes only. It is not optimized for production use. And it may contain bugs CURRENTLY, so feel free to contribute and report issues.</p> <p>Until now, we only do simple tests, which is not enough. But we will do much more rigorous testing in the FUTURE. And we will add more docs for you can RUN it easily, add more playgrounds for you to experiment with the models and look inside the model implementations.</p>"},{"location":"#models","title":"Models","text":"<p>10 important NLP models range from 2003 to 2020:</p> <ul> <li> NNLM(2003)</li> <li> Word2Vec(2013)</li> <li> Seq2Seq(2014)</li> <li> Attention(2014)</li> <li> fastText(2016)</li> <li> Transformer(2017)</li> <li> GPT(2018)</li> <li> BERT(2018)</li> </ul>"},{"location":"#faq","title":"FAQ","text":""},{"location":"#i-see-there-are-10-models-before-why-only-8-now","title":"I see there are 10 models before, why only 8 now?","text":"<p>Yes, I removed XLNet and T5. The main reason is that I don't have so many GPUs to train these models. Without training them by myself, I can't guarantee the correctness of the implementations. So I just keep the models that I can train and verify myself.</p>"},{"location":"#i-find-there-are-differences-between-the-implementations-in-toynlp-and-original-papers","title":"I find there are DIFFERENCES between the implementations in toynlp and original papers.","text":"<p>Yes, there are some differences in the implementations. The goal of toynlp is to provide a simple and educational implementation of these models, which may not include all the optimizations and features in original papers.</p> <p>The reason is that I want to focus on the core ideas and concepts behind each model, rather than getting bogged down in implementation details. Especially when the original papers may introduce complexities that are not essential for understanding the main contributions of the work.</p> <p>But, I do need to add docs for each model to clarify these differences and provide guidance on how to use the implementations effectively. I'll do this later. Let's first make it work and then make it better.</p>"},{"location":"#where-is-gpt-2-and-other-llms","title":"Where is GPT-2 and other LLMs?","text":"<p>Well, it's in toyllm! I separated the models into two libraries, <code>toynlp</code> for traditional \"small\" NLP models and <code>toyllm</code> for LLMs, which are typically larger and more complex.</p>"},{"location":"#like-the-toy-style-anything-else","title":"Like the \"toy\" style, anything else?","text":"<p>Glad you asked! The \"toy\" style is all about simplicity and educational value. We have another two toys besides toynlp and toyllm: toyml for traditional machine learning models; toyrl for deep reinforcement learning models.</p>"},{"location":"models/nnlm/","title":"NNLM","text":""},{"location":"models/nnlm/#toynlp.nnlm.model.NNLM","title":"toynlp.nnlm.model.NNLM","text":"<pre><code>NNLM(config: NNLMConfig)\n</code></pre> <p>               Bases: <code>Module</code></p> PARAMETER DESCRIPTION <code>config</code> <p>NNLMConfig, the model configuration.</p> <p> TYPE: <code>NNLMConfig</code> </p> Source code in <code>toynlp/nnlm/model.py</code> <pre><code>def __init__(\n    self,\n    config: NNLMConfig,\n) -&gt; None:\n    \"\"\"The Neural Network Language Model (NNLM) model.\n\n    Args:\n        config: NNLMConfig, the model configuration.\n    \"\"\"\n    super().__init__()\n    self.with_direct_connection = config.with_direct_connection\n    self.with_dropout = config.with_dropout\n    # Embedding layer: |V| x m\n    self.C = torch.nn.Embedding(config.vocab_size, config.embedding_dim)\n    self.H = torch.nn.Linear(\n        config.embedding_dim * (config.context_size - 1),\n        config.hidden_dim,\n        bias=False,\n    )\n    self.d = torch.nn.Parameter(torch.zeros(config.hidden_dim))\n    self.U = torch.nn.Linear(config.hidden_dim, config.vocab_size, bias=False)\n    self.activation = torch.nn.Tanh()\n\n    self.b = torch.nn.Parameter(torch.zeros(config.vocab_size))\n    self.W = torch.nn.Linear(\n        config.embedding_dim * (config.context_size - 1),\n        config.vocab_size,\n        bias=False,\n    )\n\n    self.dropout = torch.nn.Dropout(config.dropout_rate)\n</code></pre>"},{"location":"models/nnlm/#toynlp.nnlm.model.NNLM.forward","title":"forward","text":"<pre><code>forward(tokens: Tensor) -&gt; Tensor\n</code></pre> <p>Forward pass of the model.</p> PARAMETER DESCRIPTION <code>tokens</code> <p>torch.Tensor, (batch_size, seq_len-1), the input tokens.</p> <p> TYPE: <code>Tensor</code> </p> RETURNS DESCRIPTION <code>Tensor</code> <p>torch.Tensor, (batch_size, vocab_size), the logits.</p> Source code in <code>toynlp/nnlm/model.py</code> <pre><code>def forward(self, tokens: torch.Tensor) -&gt; torch.Tensor:\n    \"\"\"Forward pass of the model.\n\n    Args:\n        tokens: torch.Tensor, (batch_size, seq_len-1), the input tokens.\n\n    Returns:\n        torch.Tensor, (batch_size, vocab_size), the logits.\n\n    \"\"\"\n    # tokens: (batch_size, seq_len-1) -&gt; x: (batch_size, seq_len-1, embedding_dim)\n    x = self.C(tokens)\n    b, _, _ = x.shape\n    # (batch_size, seq_len-1, embedding_dim) -&gt; (batch_size, embedding_dim * (seq_len-1))\n    x = x.reshape(b, -1)  # (batch_size, embedding_dim * (seq_len-1))\n    if self.with_dropout:\n        x = self.dropout(x)\n    # (batch_size, embedding_dim * (seq_len-1)) -&gt; (batch_size, vocab_size)\n    x1 = self.b + self.U(\n        self.activation(self.H(x) + self.d),\n    )  # no direct connection\n    if not self.with_direct_connection:\n        x = x1\n    else:\n        x2 = self.W(x)\n        x = x1 + x2\n    # return logits\n    return x\n</code></pre>"}]}